<!-- Компонент пагинации -->
{% if pagination and pagination.pages > 1 %}
<nav aria-label="Навигация по страницам" class="mt-4">
    <ul class="pagination justify-content-center">
        <!-- Кнопка "Предыдущая" -->
        {% if pagination.has_prev %}
        <li class="page-item">
            <a class="page-link" href="{{ pagination.get_page_url(pagination.prev_page) }}" aria-label="Предыдущая">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <span class="page-link" aria-label="Предыдущая">
                <span aria-hidden="true">&laquo;</span>
            </span>
        </li>
        {% endif %}
        
        <!-- Номера страниц -->
        {% for link in pagination.get_pagination_links(5) %}
            {% if link.is_ellipsis %}
            <li class="page-item disabled">
                <span class="page-link">...</span>
            </li>
            {% else %}
            <li class="page-item {% if link.is_current %}active{% endif %}">
                {% if link.is_current %}
                <span class="page-link">{{ link.page }}</span>
                {% else %}
                <a class="page-link" href="{{ link.url }}">{{ link.page }}</a>
                {% endif %}
            </li>
            {% endif %}
        {% endfor %}
        
        <!-- Кнопка "Следующая" -->
        {% if pagination.has_next %}
        <li class="page-item">
            <a class="page-link" href="{{ pagination.get_page_url(pagination.next_page) }}" aria-label="Следующая">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <span class="page-link" aria-label="Следующая">
                <span aria-hidden="true">&raquo;</span>
            </span>
        </li>
        {% endif %}
    </ul>
    
    <!-- Информация о пагинации -->
    <div class="text-center text-muted small mt-2">
        Показано {{ pagination.start_index + 1 }}-{{ pagination.end_index }} из {{ pagination.total }} записей
        {% if pagination.pages > 1 %}
        (страница {{ pagination.page }} из {{ pagination.pages }})
        {% endif %}
    </div>
</nav>
{% endif %}

<!-- Компонент выбора количества записей на странице -->
{% if show_per_page_selector %}
<div class="d-flex justify-content-between align-items-center mt-3">
    <div class="d-flex align-items-center">
        <label for="per-page-select" class="form-label me-2 mb-0">Записей на странице:</label>
        <select id="per-page-select" class="form-select form-select-sm" style="width: auto;">
            <option value="10" {% if pagination.per_page == 10 %}selected{% endif %}>10</option>
            <option value="20" {% if pagination.per_page == 20 %}selected{% endif %}>20</option>
            <option value="50" {% if pagination.per_page == 50 %}selected{% endif %}>50</option>
            <option value="100" {% if pagination.per_page == 100 %}selected{% endif %}>100</option>
        </select>
    </div>
    
    <!-- Быстрая навигация -->
    {% if pagination.pages > 10 %}
    <div class="d-flex align-items-center">
        <label for="quick-page" class="form-label me-2 mb-0">Перейти к странице:</label>
        <div class="input-group input-group-sm" style="width: 120px;">
            <input type="number" id="quick-page" class="form-control" min="1" max="{{ pagination.pages }}" value="{{ pagination.page }}">
            <button class="btn btn-outline-secondary" type="button" onclick="goToPage()">→</button>
        </div>
    </div>
    {% endif %}
</div>

<script>
// Обработчик изменения количества записей на странице
document.getElementById('per-page-select').addEventListener('change', function() {
    const perPage = this.value;
    const url = new URL(window.location);
    url.searchParams.set('per_page', perPage);
    url.searchParams.delete('page'); // Сбрасываем на первую страницу
    window.location.href = url.toString();
});

// Быстрая навигация по страницам
function goToPage() {
    const pageInput = document.getElementById('quick-page');
    const page = parseInt(pageInput.value);
    const maxPage = parseInt(pageInput.max);
    
    if (page >= 1 && page <= maxPage) {
        const url = new URL(window.location);
        url.searchParams.set('page', page);
        window.location.href = url.toString();
    } else {
        alert('Введите корректный номер страницы от 1 до ' + maxPage);
        pageInput.focus();
    }
}

// Обработчик Enter в поле быстрой навигации
document.getElementById('quick-page').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        goToPage();
    }
});
</script>
{% endif %}

<style>
.pagination .page-link {
    color: #007bff;
    border-color: #dee2e6;
}

.pagination .page-item.active .page-link {
    background-color: #007bff;
    border-color: #007bff;
    color: white;
}

.pagination .page-link:hover {
    color: #0056b3;
    background-color: #e9ecef;
    border-color: #dee2e6;
}

.pagination .page-item.disabled .page-link {
    color: #6c757d;
    background-color: #fff;
    border-color: #dee2e6;
}
</style> 