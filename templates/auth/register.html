{% extends 'layout.html' %}
{% block title %}Регистрация — stanbase{% endblock %}
{% block content %}
<style>
  body { background: #f7f7f9 !important; }
  .register-card { border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.07); padding: 28px 28px 18px 28px; }
  .register-hint-card { background: #f9fafb; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); padding: 24px 24px 16px 24px; }
  .soon-badge { font-size: 0.85em; background: #e9ecef; color: #888; border-radius: 6px; padding: 2px 10px; margin-left: 8px; }
  @media (max-width: 991px) {
    .register-hint-card { margin-top: 24px; }
  }
  @media (max-width: 767px) {
    .register-card, .register-hint-card {
      padding: 16px 8px 12px 8px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
    .register-card h3, .register-hint-card h6 {
      font-size: 1.15rem;
    }
    .register-card .form-label, .register-hint-card ul, .register-hint-card .alert {
      font-size: 1rem;
    }
    .register-card input, .register-card select, .register-card button {
      font-size: 1.05rem;
      min-height: 44px;
    }
    .register-card .input-group .btn {
      min-height: 44px;
      padding-top: 0.3rem;
      padding-bottom: 0.3rem;
    }
    .register-hint-card ul.small {
      font-size: 0.98rem;
    }
    .register-hint-card .alert {
      font-size: 0.97rem;
    }
    .register-hint-card {
      margin-top: 18px;
    }
    .register-card {
      margin-bottom: 0;
    }
  }
</style>
<div class="row justify-content-center mt-4 mb-4">
  <div class="col-md-6 col-12">
    <div class="card register-card">
      <div class="card-body">
        <h3 class="mb-4 text-center">Регистрация</h3>
        <form id="registerForm" method="post" action="/register">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="first_name" class="form-label">Имя <span style="color:red">*</span></label>
              <input type="text" class="form-control" id="first_name" name="first_name" required>
            </div>
            <div class="col-md-6 mb-3">
              <label for="last_name" class="form-label">Фамилия <span style="color:red">*</span></label>
              <input type="text" class="form-control" id="last_name" name="last_name" required>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="country_id" class="form-label">Страна <span style="color:red">*</span></label>
              <select class="form-select" id="country_id" name="country_id" required>
                <option value="">Выберите страну</option>
                {% for country in countries %}
                  {% if country.name in ['Казахстан', 'Узбекистан', 'Кыргызстан', 'Таджикистан', 'Туркменистан'] %}
                    <option value="{{ country.id }}" data-code="{{
                      '7' if country.name == 'Казахстан' else
                      '998' if country.name == 'Узбекистан' else
                      '996' if country.name == 'Кыргызстан' else
                      '992' if country.name == 'Таджикистан' else
                      '993' if country.name == 'Туркменистан' else ''
                    }}" data-country="{{ country.name }}">{{ country.name }}</option>
                  {% endif %}
                {% endfor %}
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label for="city" class="form-label">Город <span style="color:red">*</span></label>
              <input type="text" class="form-control" id="city" name="city" required>
            </div>
          </div>
          <div class="mb-3">
            <label for="phone" class="form-label">Телефон (с кодом страны) <span style="color:red">*</span></label>
            <input type="tel" class="form-control" id="phone" name="phone" required pattern="^\+\d{10,15}$" placeholder="+7XXXXXXXXXX">
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email (будет логином) <span style="color:red">*</span></label>
            <input type="email" class="form-control" id="email" name="email" required>
          </div>
          <div class="mb-3">
            <label for="telegram" class="form-label">Telegram (юзернейм или номер, необязательно)</label>
            <input type="text" class="form-control" id="telegram" name="telegram">
          </div>
          <div class="mb-3">
            <label for="linkedin" class="form-label">LinkedIn (если есть)</label>
            <input type="url" class="form-control" id="linkedin" name="linkedin">
          </div>
          <div class="mb-3">
            <label for="role" class="form-label">Тип пользователя <span style="color:red">*</span></label>
            <select class="form-select" id="role" name="role" required>
              <option value="investor">Инвестор</option>
              <option value="company_owner">Владелец компании</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="password" class="form-label">Пароль <span style="color:red">*</span></label>
            <div class="input-group">
              <input type="password" class="form-control" id="password" name="password" required minlength="6">
              <button class="btn btn-outline-secondary" type="button" id="generatePassword">Сгенерировать</button>
              <button class="btn btn-outline-secondary" type="button" id="togglePassword" aria-label="Показать пароль">
                <span id="eyeIcon" class="bi bi-eye"></span>
              </button>
            </div>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="agree1" name="agree1" required>
            <label class="form-check-label" for="agree1">Я согласен с условиями использования <span style="color:red">*</span></label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="agree2" name="agree2" required>
            <label class="form-check-label" for="agree2">Я согласен с политикой конфиденциальности <span style="color:red">*</span></label>
          </div>
          <button type="submit" class="btn btn-primary w-100">Зарегистрироваться</button>
        </form>
      </div>
    </div>
  </div>
  <div class="col-md-6 col-12 d-flex align-items-stretch">
    <div class="card register-hint-card w-100 h-100">
      <div class="card-body">
        <h6 class="mb-2">Зачем нужна регистрация?</h6>
        <ul class="mb-2">
          <li>Доступ к закрытым данным и контактам.</li>
          <li>Возможность создавать публичные страницы стартапов и фондов <span class="soon-badge">Скоро</span></li>
          <li>Управление своим профилем и заявками <span class="soon-badge">Скоро</span></li>
          <li>Участие в мероприятиях и вакансиях <span class="soon-badge">Скоро</span></li>
        </ul>
        <h6 class="mt-3 mb-2">Пример заполнения:</h6>
        <ul class="small mb-2" id="exampleList">
          <li><b>Имя:</b> <span id="exFirst">Айдар</span></li>
          <li><b>Фамилия:</b> <span id="exLast">Ахметов</span></li>
          <li><b>Страна:</b> <span id="exCountry">Казахстан</span></li>
          <li><b>Город:</b> <span id="exCity">Алматы</span></li>
          <li><b>Телефон:</b> <span id="exPhone">+77071234567</span></li>
          <li><b>Email:</b> example@email.com</li>
          <li><b>Telegram:</b> @username</li>
          <li><b>LinkedIn:</b> https://linkedin.com/in/username</li>
          <li><b>Тип пользователя:</b> Инвестор</li>
        </ul>
        <div class="alert alert-info mt-3 small">
          <b>Важно:</b> После регистрации вы сможете подать заявку на публикацию публичной страницы стартапа или фонда. Все заявки проходят модерацию.
        </div>
      </div>
    </div>
  </div>
</div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<script>
// Генерация пароля
const genBtn = document.getElementById('generatePassword');
if (genBtn) {
  genBtn.addEventListener('click', function() {
    const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789!@#$%';
    let pass = '';
    for (let i = 0; i < 10; i++) pass += chars[Math.floor(Math.random() * chars.length)];
    document.getElementById('password').value = pass;
  });
}
// Показать/скрыть пароль
const toggleBtn = document.getElementById('togglePassword');
const passInput = document.getElementById('password');
const eyeIcon = document.getElementById('eyeIcon');
if (toggleBtn && passInput) {
  toggleBtn.addEventListener('click', function() {
    if (passInput.type === 'password') {
      passInput.type = 'text';
      if (eyeIcon) eyeIcon.className = 'bi bi-eye-slash';
    } else {
      passInput.type = 'password';
      if (eyeIcon) eyeIcon.className = 'bi bi-eye';
    }
  });
}
// Автозаполнение кода страны и локализация примеров
const countrySelect = document.getElementById('country_id');
const phoneInput = document.getElementById('phone');
const exFirst = document.getElementById('exFirst');
const exLast = document.getElementById('exLast');
const exCountry = document.getElementById('exCountry');
const exCity = document.getElementById('exCity');
const exPhone = document.getElementById('exPhone');
const examples = {
  'Казахстан': {first: 'Айдар', last: 'Ахметов', city: 'Алматы', phone: '+77071234567'},
  'Узбекистан': {first: 'Улугбек', last: 'Нодиров', city: 'Ташкент', phone: '+998901234567'},
  'Кыргызстан': {first: 'Нурбек', last: 'Садыков', city: 'Бишкек', phone: '+996551234567'},
  'Таджикистан': {first: 'Фируз', last: 'Саидов', city: 'Душанбе', phone: '+992931234567'},
  'Туркменистан': {first: 'Мурад', last: 'Аннаев', city: 'Ашхабад', phone: '+99365123456'}
};
if (countrySelect && phoneInput) {
  countrySelect.addEventListener('change', function() {
    const code = countrySelect.options[countrySelect.selectedIndex].getAttribute('data-code');
    const cname = countrySelect.options[countrySelect.selectedIndex].getAttribute('data-country');
    if (code) {
      phoneInput.value = '+' + code;
      phoneInput.focus();
    }
    if (cname && examples[cname]) {
      exFirst.textContent = examples[cname].first;
      exLast.textContent = examples[cname].last;
      exCountry.textContent = cname;
      exCity.textContent = examples[cname].city;
      exPhone.textContent = examples[cname].phone;
    }
  });
}
// Перемещаем шпаргалку под форму на мобильных
function moveHintCard() {
  const hint = document.querySelector('.register-hint-card');
  const formCol = document.querySelector('.register-card').parentNode;
  if (window.innerWidth < 768 && hint && formCol.nextElementSibling === hint.parentNode) {
    formCol.parentNode.appendChild(hint.parentNode);
  }
}
window.addEventListener('resize', moveHintCard);
window.addEventListener('DOMContentLoaded', moveHintCard);
</script>
{% endblock %} 