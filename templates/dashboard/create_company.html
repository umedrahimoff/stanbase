{% extends 'layout.html' %}
{% block title %}Создать компанию — stanbase{% endblock %}
{% block content %}
<style>
  body {
    padding-top: 0 !important;
  }
  .form-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
  }
  .card {
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
</style>

<div class="form-container">
  <div class="card">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="mb-0">Создать компанию</h3>
        <a href="/dashboard" class="btn btn-outline-secondary">
          <i class="bi bi-arrow-left me-2"></i>Вернуться в ЛК
        </a>
      </div>

      {% if error %}
        <div class="alert alert-danger">
          <i class="bi bi-exclamation-triangle me-2"></i>
          {% if error == 'already_has_company' %}
            У вас уже есть профиль компании. Один пользователь может создать только одну компанию.
          {% elif error == 'creation_failed' %}
            Произошла ошибка при создании профиля. Попробуйте еще раз.
          {% else %}
            {{ error }}
          {% endif %}
        </div>
      {% endif %}

      <form method="post" enctype="multipart/form-data">
        <div class="row">
          <!-- Основная информация -->
          <div class="col-md-8">
            <h5 class="mb-3">Основная информация</h5>
            
            <div class="mb-3">
              <label for="name" class="form-label">Название компании *</label>
              <input type="text" class="form-control" id="name" name="name" required>
            </div>

            <div class="mb-3">
              <label for="description" class="form-label">Описание компании</label>
              <textarea class="form-control" id="description" name="description" rows="4" placeholder="Расскажите о вашей компании, продукте или услуге..."></textarea>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="country" class="form-label">Страна</label>
                <select class="form-select" id="country" name="country">
                  <option value="">Выберите страну</option>
                  {% for country in countries %}
                    <option value="{{ country.name }}">{{ country.name }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="col-md-6">
                <label for="city" class="form-label">Город</label>
                <input type="text" class="form-control" id="city" name="city">
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="stage" class="form-label">Стадия развития</label>
                <select class="form-select" id="stage" name="stage">
                  <option value="">Выберите стадию</option>
                  {% for stage in stages %}
                    <option value="{{ stage.name }}">{{ stage.name }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="col-md-6">
                <label for="industry" class="form-label">Отрасль</label>
                <select class="form-select" id="industry" name="industry">
                  <option value="">Выберите отрасль</option>
                  {% for category in categories %}
                    <option value="{{ category.name }}">{{ category.name }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="website" class="form-label">Веб-сайт</label>
                <input type="url" class="form-control" id="website" name="website" placeholder="https://example.com">
              </div>
              <div class="col-md-6">
                <label for="founded_date" class="form-label">Дата основания</label>
                <input type="date" class="form-control" id="founded_date" name="founded_date">
              </div>
            </div>
          </div>

          <!-- Логотип -->
          <div class="col-md-4">
            <h5 class="mb-3">Логотип</h5>
            <div class="mb-3">
              <label for="logo" class="form-label">Загрузить логотип</label>
              <input type="file" class="form-control" id="logo" name="logo" accept="image/*">
              <div class="form-text">Рекомендуемый размер: 300x300px, формат: PNG, JPG</div>
            </div>
            <div id="logoPreview" class="mt-3" style="display: none;">
              <img id="previewImage" src="" alt="Предварительный просмотр" class="img-fluid rounded" style="max-width: 200px;">
            </div>
          </div>
        </div>

        <hr class="my-4">

        <div class="d-flex justify-content-between">
          <a href="/dashboard" class="btn btn-outline-secondary">Отмена</a>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-plus-circle me-2"></i>Создать компанию
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Предварительный просмотр логотипа
  document.getElementById('logo').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('previewImage').src = e.target.result;
        document.getElementById('logoPreview').style.display = 'block';
      };
      reader.readAsDataURL(file);
    } else {
      document.getElementById('logoPreview').style.display = 'none';
    }
  });
</script>
{% endblock %}