{% extends 'layout.html' %}

{% block title %}{{ investor.name }} — {{ inv_type }} в {{ investor.country }} | stanbase{% endblock %}

{% block meta_description %}{{ investor.name }} - {{ inv_type }} в {{ investor.country }}. {{ investor.description[:150] }}{% if investor.description|length > 150 %}...{% endif %} Фокус на {{ investor.focus }}. Инвестирует в стадии: {{ investor.stages }}.{% if investor.website %} Официальный сайт: {{ investor.website }}{% endif %}{% endblock %}

{% block meta_keywords %}{{ investor.name }}, {{ inv_type }}, {{ investor.country }}, {{ investor.focus }}, {{ investor.stages }}, инвестор, венчурные инвестиции, Центральная Азия{% endblock %}

{% block og_title %}{{ investor.name }} — {{ inv_type }} в {{ investor.country }} | stanbase{% endblock %}

{% block og_description %}{{ investor.name }} - {{ inv_type }} в {{ investor.country }}. {{ investor.description[:150] }}{% if investor.description|length > 150 %}...{% endif %} Фокус на {{ investor.focus }}. Инвестирует в стадии: {{ investor.stages }}.{% if investor.website %} Официальный сайт: {{ investor.website }}{% endif %}{% endblock %}

{% block twitter_title %}{{ investor.name }} — {{ inv_type }} в {{ investor.country }} | stanbase{% endblock %}

{% block twitter_description %}{{ investor.name }} - {{ inv_type }} в {{ investor.country }}. {{ investor.description[:150] }}{% if investor.description|length > 150 %}...{% endif %} Фокус на {{ investor.focus }}. Инвестирует в стадии: {{ investor.stages }}.{% endblock %}

{% block content %}
{% if not (session is defined and session.get('user_id')) %}
<div class="alert alert-warning d-flex justify-content-between align-items-center mb-4">
  <span>Для доступа к полной информации, пожалуйста, авторизуйтесь</span>
  <button type="button" class="btn btn-sm btn-outline-primary ms-3 open-login-modal">Войти</button>
</div>
{% endif %}
<div class="row mb-4">
  <div class="col-lg-8">
    <div class="card mb-4 shadow-sm">
      <div class="card-body d-flex align-items-center mb-2">
        {% if investor.logo %}
          <img src="{{ investor.logo }}" alt="logo" width="48" height="48" class="rounded-circle me-3" style="object-fit:cover;">
        {% else %}
          <img src="https://api.dicebear.com/7.x/identicon/svg?seed={{ investor.name|urlencode }}" alt="logo" width="48" height="48" class="rounded-circle me-3" style="object-fit:cover;">
        {% endif %}
        <div>
          <h2 class="mb-1">{{ investor.name }}</h2>
          <div class="mb-2 text-muted small">{{ investor.country }} | {{ inv_type }}</div>
        </div>
      </div>
      <div class="card-body pt-0">
        <p class="mb-3">{{ investor.description }}</p>
        {% if investor.website %}
          <div class="mb-2"><b>Сайт:</b> <a href="{{ investor.website }}" target="_blank">{{ investor.website }}</a></div>
        {% endif %}
        <div class="mb-3"><b>Стадии инвестирования:</b>
          {% for stage in investor.stages.split(',') %}
            <span class="badge bg-info text-dark me-1">{{ stage.strip() }}</span>
          {% endfor %}
        </div>
        <hr>
        {% if investor.type in ['angel', 'venture'] %}
        <h5 class="mb-2">Портфель</h5>
        {% if portfolio_companies %}
          <ul class="list-group mb-4">
            {% for item in portfolio_companies %}
              <li class="list-group-item">
                {% if session is defined and session.get('user_id') %}
                  <div class="d-flex align-items-center">
                    {% if item.company.logo %}
                      <img src="{{ item.company.logo }}" alt="logo" width="32" height="32" class="rounded-circle me-2" style="object-fit:cover;">
                    {% else %}
                      <img src="https://api.dicebear.com/7.x/identicon/svg?seed={{ item.company.name|urlencode }}" alt="logo" width="32" height="32" class="rounded-circle me-2" style="object-fit:cover;">
                    {% endif %}
                    <div class="flex-grow-1">
                      <div class="d-flex align-items-center mb-1">
                        <h6 class="card-title mb-0 me-2">
                          <a href="/company/{{ item.company.id }}" class="text-decoration-none">{{ item.company.name }}</a>
                        </h6>
                        <span class="text-muted small me-2">{{ item.company.country }}{% if item.company.city %}, {{ item.company.city }}{% endif %}</span>
                        {% if item.company_stage %}
                          <span class="badge bg-light text-dark small">{{ item.company_stage }}</span>
                        {% endif %}
                      </div>
                      <div class="small">
                        {% if item.deal_amount %}
                          <span class="me-2"><strong>{{ "{:,.0f}".format(item.deal_amount) }} $</strong></span>
                        {% endif %}
                        {% if item.deal_valuation %}
                          <span class="me-2">Оценка: {{ "{:,.0f}".format(item.deal_valuation) }} $</span>
                        {% endif %}
                        {% if item.deal_date %}
                          <span class="text-muted">{{ item.deal_date.strftime('%d.%m.%Y') }}</span>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                {% else %}
                  <div class="d-flex align-items-center">
                    <img src="https://api.dicebear.com/7.x/identicon/svg?seed=hidden" alt="logo" width="32" height="32" class="rounded-circle me-2" style="object-fit:cover;">
                    <div class="flex-grow-1">
                      <h6 class="card-title mb-0">{{ item.company.name[:2] }}****</h6>
                      <div class="text-muted small">Информация скрыта</div>
                    </div>
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">Нет данных о портфеле.</div>
        {% endif %}
        {% endif %}
        
        {% if investor.type == 'venture' and investor.team %}
        <hr>
        <h5 class="mb-2">Команда</h5>
        <ul class="list-group mb-3">
          {% for p in investor.team %}
            <li class="list-group-item team-member-item">
              {% if session is defined and session.get('user_id') %}
                <span><b>{{ p.name }}</b> — {{ p.role }}</span>
                <div class="social-icons-container">
                  {% if p.linkedin %}
                    <a href="{{ p.linkedin }}" target="_blank" class="social-icon social-icon-linkedin" title="LinkedIn">
                      <i class="bi bi-linkedin"></i>
                    </a>
                  {% endif %}
                  {% if p.telegram %}
                    <a href="{% if p.telegram.startswith('@') %}https://t.me/{{ p.telegram[1:] }}{% elif p.telegram.startswith('http') %}{{ p.telegram }}{% else %}https://t.me/{{ p.telegram }}{% endif %}" target="_blank" class="social-icon social-icon-telegram" title="Telegram">
                      <i class="bi bi-telegram"></i>
                    </a>
                  {% endif %}
                  {% if p.website %}
                    <a href="{{ p.website }}" target="_blank" class="social-icon social-icon-website" title="Веб-сайт">
                      <i class="bi bi-globe"></i>
                    </a>
                  {% endif %}
                  {% if p.instagram %}
                    <a href="{% if p.instagram.startswith('@') %}https://instagram.com/{{ p.instagram[1:] }}{% elif p.instagram.startswith('http') %}{{ p.instagram }}{% else %}https://instagram.com/{{ p.instagram }}{% endif %}" target="_blank" class="social-icon social-icon-instagram" title="Instagram">
                      <i class="bi bi-instagram"></i>
                    </a>
                  {% endif %}
                </div>
              {% else %}
                <span>{{ p.name[:2] }}****</span>
                <div class="social-icons-container"></div>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="mb-3">Похожие инвесторы</h5>
        {% if similar %}
          <ul class="list-group list-group-flush">
            {% for inv in similar %}
              <li class="list-group-item">
                <a href="/investor/{{ inv.id }}"><b>{{ inv.name }}</b></a><br>
                <span class="text-muted small">{{ inv.country }} | {{ inv.focus }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">Нет похожих инвесторов.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block styles %}
{{ super() }}
<style>
.blurred {
  color: transparent;
  text-shadow: 0 0 8px #888;
  background: repeating-linear-gradient(90deg, #eee 0 10px, #fff 10px 20px);
  border-radius: 4px;
  padding: 0 8px;
  user-select: none;
}
</style>
{% endblock %} 